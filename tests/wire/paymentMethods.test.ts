/**
 * This file was auto-generated by Fern from our API Definition.
 */

import { mockServerPool } from "../mock-server/MockServerPool";
import { MercoaClient } from "../../src/Client";

describe("PaymentMethods", () => {
    test("find", async () => {
        const server = mockServerPool.createServer();
        const client = new MercoaClient({ token: "test", xApiVersion: "2024-08-01", environment: server.baseUrl });

        const rawResponseBody = {
            count: 1,
            hasMore: false,
            data: [
                {
                    paymentMethod: {
                        id: "pm_4794d597-70dc-4fec-b6ec-c5988e759769",
                        type: "bankAccount",
                        accountName: "My Checking Account",
                        bankName: "Chase",
                        routingNumber: "12345678",
                        accountNumber: "99988767623",
                        accountType: "CHECKING",
                        status: "VERIFIED",
                        isDefaultSource: true,
                        isDefaultDestination: true,
                        supportedCurrencies: ["USD"],
                        metadata: {},
                        frozen: false,
                        confirmedByEntity: true,
                        createdAt: "2021-01-01T00:00:00Z",
                        updatedAt: "2021-01-01T00:00:00Z",
                    },
                    entity: {
                        id: "ent_8545a84e-a45f-41bf-bdf1-33b42a55812c",
                        foreignId: "MY-DB-ID-12345",
                        name: "Acme Inc.",
                        email: "customer@acme.com",
                        acceptedTos: true,
                        status: "verified",
                        isCustomer: true,
                        isPayor: true,
                        isPayee: false,
                        isNetworkPayor: false,
                        isNetworkPayee: false,
                        accountType: "business",
                        updatedAt: "2024-01-02T00:00:00Z",
                        createdAt: "2024-01-01T00:00:00Z",
                        profile: {
                            business: {
                                email: "customer@acme.com",
                                legalBusinessName: "Acme Inc.",
                                businessType: "llc",
                                phone: { countryCode: "1", number: "4155551234" },
                                address: {
                                    addressLine1: "123 Main St",
                                    addressLine2: "Unit 1",
                                    city: "San Francisco",
                                    stateOrProvince: "CA",
                                    postalCode: "94105",
                                    country: "US",
                                },
                                taxIDProvided: true,
                                taxId: { ein: { number: "12-3456789" } },
                                ownersProvided: true,
                            },
                        },
                    },
                },
            ],
        };
        server.mockEndpoint().get("/paymentMethods").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.paymentMethods.find();
        expect(response).toEqual({
            count: 1,
            hasMore: false,
            data: [
                {
                    paymentMethod: {
                        type: "bankAccount",
                        id: "pm_4794d597-70dc-4fec-b6ec-c5988e759769",
                        accountName: "My Checking Account",
                        bankName: "Chase",
                        routingNumber: "12345678",
                        accountNumber: "99988767623",
                        accountType: "CHECKING",
                        status: "VERIFIED",
                        isDefaultSource: true,
                        isDefaultDestination: true,
                        supportedCurrencies: ["USD"],
                        metadata: {},
                        frozen: false,
                        confirmedByEntity: true,
                        createdAt: new Date("2021-01-01T00:00:00.000Z"),
                        updatedAt: new Date("2021-01-01T00:00:00.000Z"),
                    },
                    entity: {
                        id: "ent_8545a84e-a45f-41bf-bdf1-33b42a55812c",
                        foreignId: "MY-DB-ID-12345",
                        name: "Acme Inc.",
                        email: "customer@acme.com",
                        acceptedTos: true,
                        status: "verified",
                        isCustomer: true,
                        isPayor: true,
                        isPayee: false,
                        isNetworkPayor: false,
                        isNetworkPayee: false,
                        accountType: "business",
                        updatedAt: new Date("2024-01-02T00:00:00.000Z"),
                        createdAt: new Date("2024-01-01T00:00:00.000Z"),
                        profile: {
                            business: {
                                email: "customer@acme.com",
                                legalBusinessName: "Acme Inc.",
                                businessType: "llc",
                                phone: {
                                    countryCode: "1",
                                    number: "4155551234",
                                },
                                address: {
                                    addressLine1: "123 Main St",
                                    addressLine2: "Unit 1",
                                    city: "San Francisco",
                                    stateOrProvince: "CA",
                                    postalCode: "94105",
                                    country: "US",
                                },
                                taxIdProvided: true,
                                taxId: {
                                    ein: {
                                        number: "12-3456789",
                                    },
                                },
                                ownersProvided: true,
                            },
                        },
                    },
                },
            ],
        });
    });
});
